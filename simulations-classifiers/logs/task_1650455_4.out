Running task 4: uv run python src/classifiers/pipeline.py --config config/kernel_size_1/viridiplantae/WAG_frequencies.json
2025-05-25 14:36:44   Tokenizing real alignments...
2025-05-25 14:36:45   Removing sequences with ambiguous tokens...
2025-05-25 14:36:45   0/20290 sequences have been removed from 0/1497 alignements due to ambiguous sites.
2025-05-25 14:36:45   Tokenizing simulated alignments...
2025-05-25 14:36:46   Removing sequences with ambiguous tokens...
2025-05-25 14:36:46   0/17109 sequences have been removed from 0/2413 alignements due to ambiguous sites.
2025-05-25 14:36:46   Checking alignments...
2025-05-25 14:36:46   30 renamed keys in simulated aligns.
2025-05-25 14:36:46   Creating labels...
2025-05-25 14:36:46   Merging aligns and labels...
2025-05-25 14:36:46   Total number of alignments: 3910
2025-05-25 14:36:46   --- Preprocessing base data ---
2025-05-25 14:36:46   Tokenizing real alignments...
2025-05-25 14:36:46   Removing sequences with ambiguous tokens...
2025-05-25 14:36:46   0/20290 sequences have been removed from 0/1497 alignements due to ambiguous sites.
2025-05-25 14:36:46   Tokenizing simulated alignments...
2025-05-25 14:36:47   Removing sequences with ambiguous tokens...
2025-05-25 14:36:47   0/17109 sequences have been removed from 0/2413 alignements due to ambiguous sites.
2025-05-25 14:36:47   Checking alignments...
2025-05-25 14:36:47   30 renamed keys in simulated aligns.
2025-05-25 14:36:47   Creating labels...
2025-05-25 14:36:47   Merging aligns and labels...
2025-05-25 14:36:47   Total number of alignments: 3910
2025-05-25 14:36:47   --- Start running AACnnClassifier ---
--- Hyperparameters ---
model = AAConvNet(
  (conv_layer): Sequential(
    (0): Conv1d(22, 64, kernel_size=(1,), stride=(1,))
    (1): ReLU()
    (2): AdaptiveAvgPool1d(output_size=1)
    (3): Dropout(p=0.2, inplace=False)
  )
  (dense_layer): Linear(in_features=64, out_features=1, bias=True)
)
split_proportion = 0.9
batch_pad_sequences = False
learning_rate = 0.01
batch_size = 64
max_epochs = 500
early_stopping_patience = 20
kernel_size = 1
--- Creating loaders ---
--- nvidia-smi output ---
nvidia-smi cannot be run: Command 'nvidia-smi' returned non-zero exit status 18.
--- Training start ---
Start training using cuda device.
Number of model parameters: 1537.
Epoch   Train loss   Valid loss   Valid acc    F1-score        Lr   Best
------------------------------------------------------------------------
    1        0.687        0.687       0.372       0.000   0.00000      *
    2        0.666        0.660       0.367       0.000   0.00250      *
    3        0.665        0.659       0.628       0.772   0.00500      *
    4        0.661        0.655       0.651       0.781   0.00750      *
    5        0.651        0.645       0.400       0.100   0.01000      *
    6        0.638        0.627       0.628       0.772   0.00990      *
    7        0.617        0.607       0.641       0.776   0.00980      *
    8        0.601        0.588       0.669       0.789   0.00970      *
    9        0.586        0.573       0.700       0.802   0.00961      *
   10        0.574        0.557       0.700       0.801   0.00951      *
   11        0.563        0.543       0.708       0.807   0.00941      *
   12        0.555        0.544       0.713       0.810   0.00932       
   13        0.547        0.538       0.731       0.819   0.00923      *
   14        0.540        0.520       0.785       0.848   0.00914      *
   15        0.534        0.509       0.790       0.851   0.00904      *
   16        0.530        0.510       0.751       0.830   0.00895       
   17        0.524        0.506       0.769       0.840   0.00886      *
   18        0.519        0.494       0.790       0.848   0.00878      *
   19        0.515        0.488       0.790       0.848   0.00869      *
   20        0.511        0.482       0.800       0.854   0.00860      *
   21        0.507        0.482       0.800       0.854   0.00851       
   22        0.504        0.480       0.795       0.851   0.00843      *
   23        0.502        0.477       0.800       0.854   0.00835      *
   24        0.500        0.477       0.790       0.850   0.00826       
   25        0.497        0.472       0.803       0.857   0.00818      *
   26        0.500        0.461       0.838       0.874   0.00810      *
   27        0.494        0.474       0.790       0.850   0.00802       
   28        0.491        0.465       0.805       0.859   0.00794       
   29        0.488        0.455       0.823       0.869   0.00786      *
   30        0.486        0.453       0.823       0.869   0.00778      *
   31        0.485        0.455       0.810       0.861   0.00770       
   32        0.484        0.457       0.813       0.864   0.00762       
   33        0.481        0.449       0.823       0.869   0.00755      *
   34        0.480        0.446       0.828       0.872   0.00747      *
   35        0.478        0.447       0.826       0.870   0.00740       
   36        0.477        0.442       0.828       0.871   0.00732      *
   37        0.475        0.446       0.821       0.867   0.00725       
   38        0.474        0.442       0.826       0.870   0.00718      *
   39        0.474        0.447       0.818       0.866   0.00711       
   40        0.472        0.440       0.826       0.870   0.00703      *
   41        0.471        0.440       0.821       0.868   0.00696       
   42        0.472        0.435       0.831       0.869   0.00689      *
   43        0.469        0.437       0.828       0.871   0.00683       
   44        0.468        0.434       0.833       0.874   0.00676      *
   45        0.468        0.445       0.823       0.870   0.00669       
   46        0.466        0.436       0.821       0.867   0.00662       
   47        0.466        0.441       0.826       0.872   0.00656       
   48        0.464        0.437       0.823       0.868   0.00649       
   49        0.464        0.443       0.826       0.871   0.00643       
   50        0.463        0.428       0.836       0.875   0.00636      *
   51        0.462        0.432       0.821       0.866   0.00630       
   52        0.461        0.427       0.831       0.873   0.00624      *
   53        0.461        0.423       0.838       0.878   0.00617      *
   54        0.460        0.435       0.823       0.869   0.00611       
   55        0.459        0.427       0.836       0.876   0.00605       
   56        0.459        0.429       0.826       0.870   0.00599       
   57        0.458        0.430       0.823       0.868   0.00593       
   58        0.457        0.427       0.823       0.868   0.00587       
   59        0.457        0.426       0.826       0.870   0.00581       
   60        0.457        0.427       0.826       0.869   0.00575       
   61        0.456        0.428       0.823       0.868   0.00570       
   62        0.456        0.427       0.823       0.868   0.00564       
   63        0.455        0.426       0.823       0.868   0.00558       
   64        0.455        0.425       0.823       0.868   0.00553       
   65        0.455        0.430       0.831       0.875   0.00547       
   66        0.453        0.416       0.836       0.876   0.00542      *
   67        0.453        0.417       0.836       0.876   0.00536       
   68        0.454        0.430       0.831       0.875   0.00531       
   69        0.452        0.418       0.833       0.874   0.00526       
   70        0.451        0.419       0.833       0.874   0.00520       
   71        0.452        0.425       0.828       0.872   0.00515       
   72        0.451        0.424       0.826       0.870   0.00510       
   73        0.451        0.421       0.823       0.868   0.00505       
   74        0.450        0.416       0.833       0.874   0.00500      *
   75        0.450        0.412       0.849       0.885   0.00495      *
   76        0.450        0.414       0.841       0.879   0.00490       
   77        0.449        0.419       0.831       0.873   0.00485       
   78        0.448        0.417       0.831       0.873   0.00480       
   79        0.448        0.414       0.846       0.883   0.00475       
   80        0.448        0.420       0.828       0.871   0.00471       
   81        0.448        0.411       0.849       0.885   0.00466      *
   82        0.450        0.408       0.838       0.875   0.00461      *
   83        0.447        0.414       0.841       0.879   0.00457       
   84        0.447        0.418       0.833       0.874   0.00452       
   85        0.447        0.410       0.846       0.882   0.00448       
   86        0.446        0.411       0.846       0.883   0.00443       
   87        0.447        0.422       0.828       0.872   0.00439       
   88        0.447        0.426       0.828       0.872   0.00434       
   89        0.445        0.410       0.846       0.883   0.00430       
   90        0.445        0.407       0.844       0.881   0.00426      *
   91        0.445        0.412       0.831       0.873   0.00421       
   92        0.444        0.410       0.841       0.879   0.00417       
   93        0.444        0.408       0.844       0.881   0.00413       
   94        0.444        0.413       0.828       0.871   0.00409       
   95        0.444        0.409       0.833       0.874   0.00405       
   96        0.444        0.405       0.844       0.881   0.00401      *
   97        0.443        0.410       0.831       0.873   0.00397       
   98        0.443        0.412       0.823       0.868   0.00393       
   99        0.443        0.408       0.833       0.874   0.00389       
  100        0.443        0.412       0.823       0.868   0.00385       
  101        0.443        0.412       0.831       0.873   0.00381       
  102        0.442        0.406       0.846       0.883   0.00377       
  103        0.442        0.408       0.838       0.878   0.00373       
  104        0.442        0.416       0.828       0.872   0.00370       
  105        0.442        0.413       0.831       0.873   0.00366       
  106        0.441        0.407       0.846       0.883   0.00362       
  107        0.441        0.412       0.833       0.875   0.00359       
  108        0.441        0.410       0.833       0.874   0.00355       
  109        0.441        0.411       0.833       0.875   0.00352       
  110        0.441        0.409       0.836       0.876   0.00348       
  111        0.440        0.409       0.836       0.876   0.00345       
  112        0.440        0.405       0.846       0.883   0.00341       
  113        0.440        0.405       0.846       0.883   0.00338       
  114        0.441        0.415       0.831       0.874   0.00334       
  115        0.440        0.408       0.836       0.876   0.00331       
  116        0.440        0.409       0.838       0.878   0.00328       
--- Training ended ---
Number of model parameters: 1537
Training time: 0:02:39
Best epoch: 96
Best valid loss: 0.405
Best valid accuracy (macro): 0.844
Best F1 score: 0.881
2025-05-25 14:39:28   --- End running AACnnClassifier ---
