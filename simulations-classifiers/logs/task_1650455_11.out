Running task 11: uv run python src/classifiers/pipeline.py --config config/kernel_size_3/viridiplantae/DSO78_frequencies.json
2025-05-25 14:57:50   Tokenizing real alignments...
2025-05-25 14:57:51   Removing sequences with ambiguous tokens...
2025-05-25 14:57:51   0/20290 sequences have been removed from 0/1497 alignements due to ambiguous sites.
2025-05-25 14:57:51   Tokenizing simulated alignments...
2025-05-25 14:57:51   Removing sequences with ambiguous tokens...
2025-05-25 14:57:51   0/17109 sequences have been removed from 0/2413 alignements due to ambiguous sites.
2025-05-25 14:57:52   Checking alignments...
2025-05-25 14:57:52   30 renamed keys in simulated aligns.
2025-05-25 14:57:52   Creating labels...
2025-05-25 14:57:52   Merging aligns and labels...
2025-05-25 14:57:52   Total number of alignments: 3910
2025-05-25 14:57:52   --- Preprocessing base data ---
2025-05-25 14:57:52   Tokenizing real alignments...
2025-05-25 14:57:52   Removing sequences with ambiguous tokens...
2025-05-25 14:57:52   0/20290 sequences have been removed from 0/1497 alignements due to ambiguous sites.
2025-05-25 14:57:52   Tokenizing simulated alignments...
2025-05-25 14:57:53   Removing sequences with ambiguous tokens...
2025-05-25 14:57:53   0/17109 sequences have been removed from 0/2413 alignements due to ambiguous sites.
2025-05-25 14:57:53   Checking alignments...
2025-05-25 14:57:53   30 renamed keys in simulated aligns.
2025-05-25 14:57:53   Creating labels...
2025-05-25 14:57:53   Merging aligns and labels...
2025-05-25 14:57:53   Total number of alignments: 3910
2025-05-25 14:57:53   --- Start running AACnnClassifier ---
--- Hyperparameters ---
model = AAConvNet(
  (conv_layer): Sequential(
    (0): Conv1d(22, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    (1): ReLU()
    (2): AdaptiveAvgPool1d(output_size=1)
    (3): Dropout(p=0.2, inplace=False)
  )
  (dense_layer): Linear(in_features=64, out_features=1, bias=True)
)
split_proportion = 0.9
batch_pad_sequences = False
learning_rate = 0.01
batch_size = 64
max_epochs = 500
early_stopping_patience = 20
kernel_size = 3
--- Creating loaders ---
--- nvidia-smi output ---
nvidia-smi cannot be run: Command 'nvidia-smi' returned non-zero exit status 18.
--- Training start ---
Start training using cuda device.
Number of model parameters: 4353.
Epoch   Train loss   Valid loss   Valid acc    F1-score        Lr   Best
------------------------------------------------------------------------
    1        0.684        0.683       0.372       0.000   0.00000      *
    2        0.665        0.660       0.597       0.647   0.00250      *
    3        0.658        0.651       0.608       0.569   0.00500      *
    4        0.650        0.632       0.710       0.805   0.00750      *
    5        0.606        0.593       0.685       0.797   0.01000      *
    6        0.587        0.594       0.651       0.782   0.00990       
    7        0.557        0.542       0.746       0.827   0.00980      *
    8        0.544        0.524       0.762       0.826   0.00970      *
    9        0.533        0.514       0.764       0.836   0.00961      *
   10        0.524        0.501       0.769       0.834   0.00951      *
   11        0.522        0.490       0.779       0.829   0.00941      *
   12        0.515        0.506       0.769       0.835   0.00932       
   13        0.509        0.483       0.779       0.834   0.00923      *
   14        0.507        0.487       0.764       0.826   0.00914       
   15        0.507        0.471       0.785       0.834   0.00904      *
   16        0.503        0.466       0.777       0.830   0.00895      *
   17        0.499        0.470       0.772       0.829   0.00886       
   18        0.498        0.471       0.772       0.829   0.00878       
   19        0.496        0.467       0.777       0.832   0.00869       
   20        0.495        0.466       0.777       0.831   0.00860      *
   21        0.496        0.459       0.787       0.837   0.00851      *
   22        0.493        0.465       0.774       0.831   0.00843       
   23        0.503        0.498       0.769       0.835   0.00835       
   24        0.492        0.468       0.769       0.828   0.00826       
   25        0.492        0.454       0.785       0.835   0.00818      *
   26        0.490        0.466       0.777       0.832   0.00810       
   27        0.489        0.458       0.782       0.835   0.00802       
   28        0.488        0.464       0.777       0.832   0.00794       
   29        0.487        0.457       0.782       0.835   0.00786       
   30        0.489        0.453       0.785       0.834   0.00778      *
   31        0.488        0.473       0.772       0.830   0.00770       
   32        0.487        0.453       0.790       0.840   0.00762       
   33        0.491        0.450       0.803       0.844   0.00755      *
   34        0.485        0.458       0.790       0.840   0.00747       
   35        0.485        0.454       0.787       0.839   0.00740       
   36        0.486        0.472       0.772       0.830   0.00732       
   37        0.484        0.462       0.785       0.837   0.00725       
   38        0.483        0.456       0.790       0.840   0.00718       
   39        0.484        0.470       0.787       0.840   0.00711       
   40        0.484        0.449       0.785       0.835   0.00703      *
   41        0.486        0.479       0.769       0.830   0.00696       
   42        0.484        0.448       0.785       0.834   0.00689      *
   43        0.482        0.450       0.782       0.832   0.00683       
   44        0.481        0.455       0.792       0.842   0.00676       
   45        0.481        0.462       0.785       0.837   0.00669       
   46        0.482        0.445       0.790       0.838   0.00662      *
   47        0.482        0.446       0.787       0.836   0.00656       
   48        0.480        0.446       0.787       0.837   0.00649       
   49        0.481        0.442       0.792       0.840   0.00643      *
   50        0.479        0.447       0.787       0.837   0.00636       
   51        0.479        0.450       0.787       0.837   0.00630       
   52        0.478        0.447       0.790       0.839   0.00624       
   53        0.482        0.441       0.800       0.844   0.00617      *
   54        0.478        0.456       0.790       0.841   0.00611       
   55        0.477        0.452       0.790       0.840   0.00605       
   56        0.477        0.455       0.787       0.839   0.00599       
   57        0.476        0.446       0.792       0.841   0.00593       
   58        0.477        0.442       0.787       0.836   0.00587       
   59        0.477        0.442       0.787       0.837   0.00581       
   60        0.476        0.444       0.792       0.841   0.00575       
   61        0.480        0.438       0.805       0.847   0.00570      *
   62        0.475        0.443       0.790       0.839   0.00564       
   63        0.475        0.443       0.790       0.839   0.00558       
   64        0.477        0.439       0.800       0.845   0.00553       
   65        0.476        0.440       0.797       0.844   0.00547       
   66        0.474        0.445       0.792       0.842   0.00542       
   67        0.475        0.440       0.790       0.839   0.00536       
   68        0.474        0.448       0.795       0.844   0.00531       
   69        0.474        0.448       0.795       0.844   0.00526       
   70        0.475        0.460       0.787       0.839   0.00520       
   71        0.474        0.456       0.787       0.839   0.00515       
   72        0.479        0.438       0.810       0.848   0.00510      *
   73        0.474        0.438       0.795       0.841   0.00505       
   74        0.473        0.441       0.792       0.841   0.00500       
   75        0.472        0.442       0.790       0.840   0.00495       
   76        0.473        0.456       0.790       0.841   0.00490       
   77        0.473        0.438       0.797       0.843   0.00485      *
   78        0.471        0.446       0.792       0.842   0.00480       
   79        0.473        0.457       0.790       0.841   0.00475       
   80        0.471        0.446       0.792       0.842   0.00471       
   81        0.472        0.456       0.790       0.841   0.00466       
   82        0.472        0.436       0.795       0.842   0.00461      *
   83        0.470        0.443       0.795       0.844   0.00457       
   84        0.470        0.443       0.795       0.844   0.00452       
   85        0.470        0.443       0.792       0.842   0.00448       
   86        0.470        0.446       0.795       0.844   0.00443       
   87        0.470        0.452       0.790       0.841   0.00439       
   88        0.470        0.435       0.797       0.844   0.00434      *
   89        0.472        0.432       0.803       0.845   0.00430      *
   90        0.468        0.438       0.792       0.841   0.00426       
   91        0.468        0.437       0.800       0.846   0.00421       
   92        0.472        0.431       0.805       0.847   0.00417      *
   93        0.468        0.442       0.792       0.842   0.00413       
   94        0.468        0.435       0.792       0.841   0.00409       
   95        0.470        0.460       0.797       0.848   0.00405       
   96        0.467        0.437       0.795       0.844   0.00401       
   97        0.467        0.437       0.797       0.845   0.00397       
   98        0.466        0.440       0.795       0.844   0.00393       
   99        0.466        0.441       0.795       0.844   0.00389       
  100        0.466        0.438       0.795       0.844   0.00385       
  101        0.466        0.434       0.797       0.844   0.00381       
  102        0.466        0.438       0.795       0.844   0.00377       
  103        0.466        0.436       0.795       0.844   0.00373       
  104        0.465        0.440       0.795       0.844   0.00370       
  105        0.465        0.435       0.797       0.845   0.00366       
  106        0.465        0.439       0.795       0.844   0.00362       
  107        0.465        0.432       0.803       0.849   0.00359       
  108        0.464        0.439       0.795       0.844   0.00355       
  109        0.464        0.434       0.800       0.847   0.00352       
  110        0.464        0.434       0.800       0.847   0.00348       
  111        0.464        0.437       0.795       0.844   0.00345       
  112        0.465        0.428       0.805       0.849   0.00341      *
  113        0.464        0.431       0.800       0.847   0.00338       
  114        0.464        0.430       0.800       0.847   0.00334       
  115        0.463        0.436       0.795       0.844   0.00331       
  116        0.463        0.438       0.792       0.842   0.00328       
  117        0.463        0.436       0.795       0.844   0.00324       
  118        0.463        0.431       0.800       0.847   0.00321       
  119        0.465        0.452       0.797       0.848   0.00318       
  120        0.462        0.434       0.797       0.845   0.00315       
  121        0.462        0.432       0.800       0.847   0.00312       
  122        0.463        0.427       0.800       0.845   0.00309      *
  123        0.462        0.431       0.800       0.847   0.00305       
  124        0.461        0.433       0.797       0.845   0.00302       
  125        0.461        0.433       0.797       0.845   0.00299       
  126        0.462        0.428       0.805       0.850   0.00296       
  127        0.462        0.425       0.803       0.848   0.00293      *
  128        0.461        0.430       0.797       0.845   0.00290       
  129        0.461        0.429       0.800       0.847   0.00288       
  130        0.461        0.432       0.795       0.844   0.00285       
  131        0.461        0.441       0.797       0.847   0.00282       
  132        0.460        0.429       0.797       0.845   0.00279       
  133        0.460        0.433       0.795       0.844   0.00276       
  134        0.460        0.434       0.795       0.844   0.00273       
  135        0.460        0.438       0.797       0.846   0.00271       
  136        0.459        0.435       0.795       0.844   0.00268       
  137        0.460        0.444       0.795       0.844   0.00265       
  138        0.459        0.430       0.797       0.845   0.00263       
  139        0.459        0.432       0.795       0.844   0.00260       
  140        0.459        0.427       0.803       0.849   0.00257       
  141        0.459        0.430       0.797       0.845   0.00255       
  142        0.459        0.425       0.808       0.852   0.00252      *
  143        0.458        0.432       0.795       0.844   0.00250       
  144        0.458        0.432       0.795       0.844   0.00247       
  145        0.460        0.423       0.810       0.853   0.00245      *
  146        0.458        0.433       0.795       0.844   0.00242       
  147        0.458        0.425       0.808       0.852   0.00240       
  148        0.458        0.427       0.797       0.845   0.00238       
  149        0.458        0.428       0.797       0.845   0.00235       
  150        0.458        0.429       0.797       0.845   0.00233       
  151        0.457        0.431       0.795       0.844   0.00231       
  152        0.457        0.427       0.797       0.845   0.00228       
  153        0.458        0.434       0.797       0.846   0.00226       
  154        0.458        0.435       0.797       0.846   0.00224       
  155        0.457        0.429       0.797       0.846   0.00221       
  156        0.458        0.421       0.810       0.853   0.00219      *
  157        0.457        0.431       0.797       0.846   0.00217       
  158        0.457        0.426       0.803       0.849   0.00215       
  159        0.457        0.426       0.800       0.848   0.00213       
  160        0.457        0.424       0.803       0.849   0.00211       
  161        0.457        0.425       0.800       0.847   0.00208       
  162        0.456        0.424       0.805       0.850   0.00206       
  163        0.456        0.427       0.800       0.848   0.00204       
  164        0.456        0.431       0.797       0.846   0.00202       
  165        0.456        0.426       0.800       0.848   0.00200       
  166        0.456        0.423       0.808       0.852   0.00198       
  167        0.456        0.426       0.800       0.848   0.00196       
  168        0.456        0.425       0.803       0.849   0.00194       
  169        0.456        0.424       0.803       0.849   0.00192       
  170        0.456        0.429       0.797       0.846   0.00190       
  171        0.455        0.426       0.797       0.846   0.00189       
  172        0.456        0.432       0.797       0.846   0.00187       
  173        0.455        0.428       0.797       0.846   0.00185       
  174        0.457        0.442       0.800       0.849   0.00183       
  175        0.455        0.420       0.810       0.854   0.00181      *
  176        0.455        0.426       0.797       0.846   0.00179       
  177        0.454        0.427       0.797       0.846   0.00178       
  178        0.455        0.421       0.810       0.854   0.00176       
  179        0.454        0.427       0.797       0.846   0.00174       
  180        0.454        0.423       0.805       0.850   0.00172       
  181        0.454        0.423       0.803       0.849   0.00171       
  182        0.454        0.425       0.803       0.849   0.00169       
  183        0.454        0.423       0.805       0.851   0.00167       
  184        0.454        0.420       0.810       0.854   0.00165       
  185        0.454        0.425       0.797       0.846   0.00164       
  186        0.453        0.423       0.803       0.849   0.00162       
  187        0.453        0.425       0.800       0.848   0.00161       
  188        0.453        0.424       0.803       0.849   0.00159       
  189        0.453        0.424       0.800       0.848   0.00157       
  190        0.453        0.426       0.800       0.848   0.00156       
  191        0.453        0.423       0.803       0.849   0.00154       
  192        0.453        0.423       0.805       0.851   0.00153       
  193        0.453        0.431       0.797       0.846   0.00151       
  194        0.453        0.426       0.800       0.848   0.00150       
  195        0.453        0.422       0.805       0.851   0.00148       
--- Training ended ---
Number of model parameters: 4353
Training time: 0:04:33
Best epoch: 175
Best valid loss: 0.420
Best valid accuracy (macro): 0.810
Best F1 score: 0.854
2025-05-25 15:02:28   --- End running AACnnClassifier ---
